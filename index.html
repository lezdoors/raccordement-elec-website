<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raccordement Électrique Enedis - Votre Partenaire Expert N°1 France</title>
    <meta name="description" content="Service expert N°1 en France pour vos raccordements électriques Enedis. Accompagnement administratif professionnel pour particuliers, professionnels et collectivités.">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6LL9H8D08T"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-6LL9H8D08T');
    </script>

    <style>
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        :root {
            --enedis-blue: #0b1ede;
            --enedis-green: #6dc067;
        }
        
        .enedis-blue { color: var(--enedis-blue); }
        .bg-enedis-blue { background-color: var(--enedis-blue); }
        .enedis-green { color: var(--enedis-green); }
        .bg-enedis-green { background-color: var(--enedis-green); }
        .border-enedis-blue { border-color: var(--enedis-blue); }
        .border-enedis-green { border-color: var(--enedis-green); }
        
        .hero-gradient {
            background: linear-gradient(135deg, var(--enedis-blue) 0%, #1e3a8a 45%, #1d4ed8 100%);
        }
        
        .btn-primary {
            background: var(--enedis-green);
            color: white;
            padding: 16px 32px;
            border-radius: 12px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 14px 0 rgba(109, 192, 103, 0.4);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px 0 rgba(109, 192, 103, 0.5);
            background: #5cb85c;
        }
        
        .btn-secondary {
            background: transparent;
            color: var(--enedis-blue);
            padding: 14px 28px;
            border: 2px solid var(--enedis-blue);
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn-secondary:hover {
            background: var(--enedis-blue);
            color: white;
        }
        
        .card-hover {
            background: white;
            border-radius: 16px;
            padding: 32px;
            transition: all 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.06);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }
        
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        
        .step-circle {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 24px;
            margin: 0 auto 24px;
            color: white;
            box-shadow: 0 4px 12px 0 rgba(0, 0, 0, 0.15);
        }
        
        .step-1 { background: var(--enedis-blue); }
        .step-2 { background: #3b82f6; }
        .step-3 { background: #6366f1; }
        .step-4 { background: var(--enedis-green); }
        
        .nav-blur {
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        }
        
        .form-input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--enedis-blue);
            box-shadow: 0 0 0 4px rgba(11, 30, 222, 0.1);
        }
        
        .progress-bar {
            height: 8px;
            background: #f1f5f9;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--enedis-blue), var(--enedis-green));
            transition: width 0.8s ease;
            border-radius: 8px;
        }
        
        .form-step {
            display: none;
        }
        
        .form-step.active {
            display: block;
            animation: slideIn 0.4s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .radio-option {
            padding: 16px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }
        
        .radio-option:hover {
            border-color: var(--enedis-blue);
        }
        
        .radio-option.selected {
            border-color: var(--enedis-blue);
            background: rgba(11, 30, 222, 0.05);
        }
        
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 280px;
            background-color: #1f2937;
            color: white;
            text-align: left;
            border-radius: 8px;
            padding: 12px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -140px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
        }
        
        .address-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            z-index: 10;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .address-suggestion {
            padding: 12px 16px;
            cursor: pointer;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .address-suggestion:hover {
            background: #f8fafc;
        }
        
        .error-message {
            color: #ef4444;
            font-size: 14px;
            margin-top: 4px;
        }
        
        @media (max-width: 768px) {
            .tooltip .tooltiptext {
                width: 240px;
                margin-left: -120px;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="nav-blur fixed w-full top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <!-- Logo -->
                <div class="flex items-center cursor-pointer" onclick="showPage('home')">
                    <img src="https://page1.genspark.site/v1/base64_upload/e676fe9df988ecff4cfc8149d4cbb09b" alt="Enedis Raccordement" class="h-12 w-auto">
                </div>
                
                <!-- Menu Desktop -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#" onclick="showPage('home')" class="text-gray-700 hover:text-enedis-blue transition-colors font-medium">Accueil</a>
                    <a href="#services" class="text-gray-700 hover:text-enedis-blue transition-colors font-medium">Services</a>
                    <a href="#faq" class="text-gray-700 hover:text-enedis-blue transition-colors font-medium">FAQ</a>
                    <a href="#contact" class="text-gray-700 hover:text-enedis-blue transition-colors font-medium">Contact</a>
                </div>
                
                <!-- CTA -->
                <div class="hidden md:flex items-center space-x-4">
                    <button onclick="showPage('formulaire')" class="btn-primary">
                        Faire ma demande
                    </button>
                    <a href="tel:0970709570" class="text-white hover:text-enedis-blue transition-colors flex items-center font-medium">
                        <i class="fas fa-phone mr-2 text-enedis-green"></i>
                        09 70 70 95 70
                    </a>
                </div>
                
                <!-- Menu Mobile -->
                <div class="md:hidden">
                    <button onclick="toggleMobileMenu()" class="text-gray-700 p-2">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t">
            <div class="px-4 py-4 space-y-3">
                <a href="#" onclick="showPage('home')" class="block py-2 text-gray-700 font-medium">Accueil</a>
                <a href="#services" class="block py-2 text-gray-700 font-medium">Services</a>
                <a href="#faq" class="block py-2 text-gray-700 font-medium">FAQ</a>
                <a href="#contact" class="block py-2 text-gray-700 font-medium">Contact</a>
                <button onclick="showPage('formulaire')" class="btn-primary w-full mt-4">Faire ma demande</button>
                <a href="tel:0970709570" class="block py-2 text-center text-gray-600 font-medium">
                    <i class="fas fa-phone mr-2 text-enedis-green"></i>09 70 70 95 70
                </a>
            </div>
        </div>
    </nav>

    <!-- Spacer for fixed nav -->
    <div class="h-20"></div>

    <!-- Page d'accueil -->
    <div id="home" class="page active">
        <!-- Hero Section -->
        <section class="hero-gradient text-white py-24 relative">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h1 class="text-4xl md:text-6xl font-bold mb-8">
                    Service Expert N°1 en France pour vos raccordements Enedis
                </h1>
                
                <p class="text-xl md:text-2xl mb-12 opacity-90 max-w-4xl mx-auto">
                    Accompagnement administratif professionnel pour vos raccordements Enedis. 
                    Expertise technique et suivi personnalisé garantis.
                </p>
                
                <div class="flex flex-col sm:flex-row gap-6 justify-center items-center">
                    <button onclick="showPage('formulaire')" class="btn-primary text-lg">
                        <i class="fas fa-arrow-right mr-3"></i>
                        Commencer ma demande
                    </button>
                    <a href="tel:0970709570" class="btn-secondary bg-transparent border-white text-white hover:bg-white hover:text-enedis-blue">
                        <i class="fas fa-phone mr-3"></i>
                        09 70 70 95 70
                    </a>
                </div>
                
                <div class="mt-12 flex items-center justify-center text-lg opacity-90">
                    <i class="fas fa-star text-yellow-400 mr-2"></i>
                    Plus de 15 000 clients satisfaits
                </div>
            </div>
        </section>

        <!-- Section Demande -->
        <section class="py-16 bg-white">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="text-3xl font-bold text-gray-900 mb-8">
                    Votre Demande de Raccordement en 4 Étapes
                </h2>
                <p class="text-lg text-gray-600 mb-8">
                    Processus simplifié pour votre raccordement Enedis personnalisé
                </p>
                
                <div class="bg-gray-50 rounded-2xl p-8 mb-8">
                    <p class="text-sm text-gray-600 mb-4">Besoin d'aide pour remplir le formulaire ?</p>
                    <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                        <a href="tel:0970709570" class="flex items-center text-enedis-blue font-semibold">
                            <i class="fas fa-phone mr-2"></i>
                            09 70 70 95 70
                        </a>
                        <span class="text-gray-500">•</span>
                        <span class="text-gray-600">Lundi-Vendredi 8h-18h</span>
                    </div>
                </div>
                
                <button onclick="showPage('formulaire')" class="btn-primary">
                    Démarrer ma demande
                </button>
            </div>
        </section>

        <!-- Section Process -->
        <section class="py-24 bg-gray-50" id="services">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-16">
                    <h2 class="text-4xl font-bold text-gray-900 mb-8">
                        Votre Raccordement en 4 Étapes
                    </h2>
                    <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                        Un processus simple et transparent pour votre raccordement Enedis
                    </p>
                </div>
                
                <div class="grid md:grid-cols-4 gap-8">
                    <!-- Étape 1 -->
                    <div class="text-center">
                        <div class="step-circle step-1">1</div>
                        <h3 class="text-xl font-bold mb-4 text-gray-900">Formulaire</h3>
                        <p class="text-gray-600">
                            Remplissez notre formulaire en 5 minutes
                        </p>
                    </div>
                    
                    <!-- Étape 2 -->
                    <div class="text-center">
                        <div class="step-circle step-2">2</div>
                        <h3 class="text-xl font-bold mb-4 text-gray-900">Préparation</h3>
                        <p class="text-gray-600">
                            Nos experts préparent votre dossier technique
                        </p>
                    </div>
                    
                    <!-- Étape 3 -->
                    <div class="text-center">
                        <div class="step-circle step-3">3</div>
                        <h3 class="text-xl font-bold mb-4 text-gray-900">Suivi</h3>
                        <p class="text-gray-600">
                            Nous suivons votre demande auprès d'Enedis
                        </p>
                    </div>
                    
                    <!-- Étape 4 -->
                    <div class="text-center">
                        <div class="step-circle step-4">4</div>
                        <h3 class="text-xl font-bold mb-4 text-gray-900">Raccordement</h3>
                        <p class="text-gray-600">
                            Enedis réalise votre raccordement
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section Services -->
        <section class="py-24 bg-white">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-16">
                    <h2 class="text-4xl font-bold text-gray-900 mb-8">
                        Types de Raccordement Enedis
                    </h2>
                    <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                        Solutions expertises adaptées à tous vos besoins électriques
                    </p>
                </div>
                
                <div class="grid md:grid-cols-3 gap-8">
                    <!-- Nouveau -->
                    <div class="card-hover text-center">
                        <div class="w-16 h-16 bg-enedis-blue rounded-2xl flex items-center justify-center mx-auto mb-6">
                            <i class="fas fa-home text-white text-2xl"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 text-gray-900">Nouveau</h3>
                        <p class="text-gray-600">
                            Raccordement définitif pour constructions neuves et premières installations
                        </p>
                    </div>
                    
                    <!-- Provisoire -->
                    <div class="card-hover text-center">
                        <div class="w-16 h-16 bg-enedis-green rounded-2xl flex items-center justify-center mx-auto mb-6">
                            <i class="fas fa-clock text-white text-2xl"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 text-gray-900">Provisoire</h3>
                        <p class="text-gray-600">
                            Raccordement temporaire pour chantiers et événements
                        </p>
                    </div>
                    
                    <!-- Modification -->
                    <div class="card-hover text-center">
                        <div class="w-16 h-16" style="background: #6366f1;" class="rounded-2xl flex items-center justify-center mx-auto mb-6">
                            <i class="fas fa-tools text-white text-2xl"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 text-gray-900">Modification</h3>
                        <p class="text-gray-600">
                            Augmentation puissance, déplacement compteur et modifications
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section CTA Final -->
        <section class="py-24 bg-enedis-blue text-white">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="text-4xl font-bold mb-8">
                    Prêt à commencer votre projet ?
                </h2>
                <p class="text-xl mb-12 opacity-90">
                    Démarrez votre demande de raccordement électrique dès maintenant
                </p>
                <button onclick="showPage('formulaire')" class="bg-enedis-green hover:bg-green-600 text-white font-bold py-4 px-8 rounded-xl text-lg transition-all duration-300">
                    <i class="fas fa-play mr-3"></i>
                    Faire ma demande
                </button>
            </div>
        </section>
    </div>

    <!-- Page Formulaire -->
    <div id="formulaire" class="page">
        <div class="min-h-screen bg-gray-50 py-12">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                <!-- Breadcrumb -->
                <nav class="flex mb-8" aria-label="Breadcrumb">
                    <ol class="inline-flex items-center space-x-1 md:space-x-3">
                        <li class="inline-flex items-center">
                            <a href="#" onclick="showPage('home')" class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-enedis-blue">
                                <i class="fas fa-home mr-2"></i>
                                Accueil
                            </a>
                        </li>
                        <li>
                            <div class="flex items-center">
                                <i class="fas fa-chevron-right text-gray-400 mx-2"></i>
                                <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2">Demande de raccordement</span>
                            </div>
                        </li>
                    </ol>
                </nav>

                <!-- Form Container -->
                <div class="bg-white rounded-2xl shadow-lg p-8">
                    <!-- Header -->
                    <div class="text-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900 mb-4">Demande de Raccordement Enedis</h1>
                        <p class="text-gray-600">Accompagnement administratif professionnel</p>
                    </div>

                    <!-- Progress Bar -->
                    <div class="mb-8">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill" style="width: 25%"></div>
                        </div>
                        <div class="flex justify-between mt-4 text-sm">
                            <span id="step-label" class="font-medium text-gray-700">Étape 1 sur 4</span>
                            <span id="step-title" class="text-gray-600">Type d'utilisateur</span>
                        </div>
                    </div>

                    <!-- Form -->
                    <form id="raccordement-form" class="space-y-6">
                        <!-- Étape 1: Type utilisateur + Coordonnées -->
                        <div class="form-step active" id="step-1">
                            <h2 class="text-2xl font-bold mb-6 text-gray-900">Type d'utilisateur</h2>
                            
                            <!-- Type d'utilisateur -->
                            <div class="mb-6">
                                <label class="block text-sm font-semibold text-gray-700 mb-4">Sélectionnez votre profil</label>
                                <div class="grid md:grid-cols-3 gap-4">
                                    <div class="radio-option" onclick="selectUserType('particulier')">
                                        <input type="radio" name="userType" value="particulier" class="sr-only">
                                        <div class="text-center">
                                            <i class="fas fa-user text-2xl text-enedis-blue mb-2"></i>
                                            <div class="font-semibold">Particulier</div>
                                            <div class="text-sm text-gray-600">Maison, appartement</div>
                                        </div>
                                    </div>
                                    <div class="radio-option" onclick="selectUserType('professionnel')">
                                        <input type="radio" name="userType" value="professionnel" class="sr-only">
                                        <div class="text-center">
                                            <i class="fas fa-building text-2xl text-enedis-blue mb-2"></i>
                                            <div class="font-semibold">Professionnel</div>
                                            <div class="text-sm text-gray-600">Entreprise, commerce</div>
                                        </div>
                                    </div>
                                    <div class="radio-option" onclick="selectUserType('collectivite')">
                                        <input type="radio" name="userType" value="collectivite" class="sr-only">
                                        <div class="text-center">
                                            <i class="fas fa-landmark text-2xl text-enedis-blue mb-2"></i>
                                            <div class="font-semibold">Collectivité</div>
                                            <div class="text-sm text-gray-600">Mairie, organisme public</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="error-message hidden" id="userType-error">Veuillez sélectionner votre type d'utilisateur</div>
                            </div>

                            <!-- Coordonnées -->
                            <h3 class="text-lg font-semibold mb-4 text-gray-900">Vos coordonnées</h3>
                            
                            <div class="grid md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-3">Prénom *</label>
                                    <input type="text" name="prenom" required class="form-input" placeholder="Votre prénom">
                                    <div class="error-message hidden" id="prenom-error">Ce champ est obligatoire</div>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-3">Nom *</label>
                                    <input type="text" name="nom" required class="form-input" placeholder="Votre nom">
                                    <div class="error-message hidden" id="nom-error">Ce champ est obligatoire</div>
                                </div>
                            </div>
                            
                            <div class="mb-6">
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Adresse email *</label>
                                <input type="email" name="email" required class="form-input" placeholder="votre@email.com">
                                <div class="text-xs text-gray-500 mt-1">Nous utiliserons cette adresse pour vous envoyer le suivi de votre demande</div>
                                <div class="error-message hidden" id="email-error">Veuillez saisir une adresse email valide</div>
                            </div>
                            
                            <div class="mb-6">
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Téléphone *</label>
                                <input type="tel" name="telephone" required class="form-input" placeholder="06 12 34 56 78" id="phone-input">
                                <div class="text-xs text-gray-500 mt-1">Numéro de téléphone français (fixe ou mobile) pour vous contacter</div>
                                <div class="error-message hidden" id="telephone-error">Veuillez saisir un numéro de téléphone français valide</div>
                            </div>

                            <!-- Champs conditionnels -->
                            <div id="professional-fields" class="hidden space-y-6">
                                <h3 class="text-lg font-semibold mb-4 text-gray-900">Informations professionnelles</h3>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-3">
                                        Raison sociale *
                                        <div class="tooltip ml-2 inline-block">
                                            <i class="fas fa-question-circle text-gray-400 cursor-help"></i>
                                            <span class="tooltiptext">Nom officiel de votre entreprise tel qu'enregistré</span>
                                        </div>
                                    </label>
                                    <input type="text" name="raisonSociale" class="form-input" placeholder="Nom de votre entreprise">
                                    <div class="error-message hidden" id="raisonSociale-error">Ce champ est obligatoire</div>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-3">
                                        Numéro SIREN *
                                        <div class="tooltip ml-2 inline-block">
                                            <i class="fas fa-question-circle text-gray-400 cursor-help"></i>
                                            <span class="tooltiptext">Le SIREN est composé de 9 chiffres</span>
                                        </div>
                                    </label>
                                    <input type="text" name="siren" class="form-input" placeholder="123 456 789" maxlength="9">
                                    <div class="text-xs text-gray-500 mt-1">9 chiffres uniquement</div>
                                    <div class="error-message hidden" id="siren-error">Le SIREN doit contenir exactement 9 chiffres</div>
                                </div>
                            </div>

                            <div id="collectivity-fields" class="hidden space-y-6">
                                <h3 class="text-lg font-semibold mb-4 text-gray-900">Informations collectivité</h3>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-3">Nom de la collectivité *</label>
                                    <input type="text" name="nomCollectivite" class="form-input" placeholder="Nom de la collectivité">
                                    <div class="error-message hidden" id="nomCollectivite-error">Ce champ est obligatoire</div>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-3">
                                        Numéro SIREN *
                                        <div class="tooltip ml-2 inline-block">
                                            <i class="fas fa-question-circle text-gray-400 cursor-help"></i>
                                            <span class="tooltiptext">Le SIREN est composé de 9 chiffres</span>
                                        </div>
                                    </label>
                                    <input type="text" name="sirenCollectivite" class="form-input" placeholder="123 456 789" maxlength="9">
                                    <div class="text-xs text-gray-500 mt-1">9 chiffres uniquement</div>
                                    <div class="error-message hidden" id="sirenCollectivite-error">Le SIREN doit contenir exactement 9 chiffres</div>
                                </div>
                            </div>
                        </div>

                        <!-- Étape 2: Adresses -->
                        <div class="form-step" id="step-2">
                            <h2 class="text-2xl font-bold mb-6 text-gray-900">Adresses</h2>
                            
                            <!-- Adresse de facturation -->
                            <div class="mb-8">
                                <h3 class="text-lg font-semibold mb-4 text-gray-900">Adresse de facturation *</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-semibold text-gray-700 mb-3">Adresse *</label>
                                        <input type="text" name="adresseFacturation" required class="form-input" placeholder="123 Rue de la République">
                                        <div class="error-message hidden" id="adresseFacturation-error">Ce champ est obligatoire</div>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-semibold text-gray-700 mb-3">Complément d'adresse</label>
                                        <input type="text" name="complementFacturation" class="form-input" placeholder="Bâtiment A, Appartement 5">
                                    </div>
                                    <div class="grid md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-semibold text-gray-700 mb-3">Code postal *</label>
                                            <input type="text" name="codePostalFacturation" required class="form-input" placeholder="75001" maxlength="5">
                                            <div class="error-message hidden" id="codePostalFacturation-error">Code postal invalide (5 chiffres requis)</div>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-semibold text-gray-700 mb-3">Ville *</label>
                                            <input type="text" name="villeFacturation" required class="form-input" placeholder="Paris">
                                            <div class="error-message hidden" id="villeFacturation-error">Ce champ est obligatoire</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Adresse du projet -->
                            <div>
                                <div class="flex items-center mb-4">
                                    <input type="checkbox" id="same-address" name="sameAddress" class="mr-3">
                                    <label for="same-address" class="text-sm font-medium text-gray-700">L'adresse du projet est la même que l'adresse de facturation</label>
                                </div>
                                
                                <div id="project-address-fields">
                                    <h3 class="text-lg font-semibold mb-4 text-gray-900">Adresse du projet *</h3>
                                    <div class="space-y-4">
                                        <div class="relative">
                                            <label class="block text-sm font-semibold text-gray-700 mb-3">Adresse du projet *</label>
                                            <input type="text" name="adresseProjet" class="form-input" placeholder="Commencez à taper votre adresse..." id="address-input">
                                            <div id="address-suggestions" class="address-suggestions hidden"></div>
                                            <div class="error-message hidden" id="adresseProjet-error">Ce champ est obligatoire</div>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-semibold text-gray-700 mb-3">Complément d'adresse</label>
                                            <input type="text" name="complementProjet" class="form-input" placeholder="Bâtiment B">
                                        </div>
                                        <div class="grid md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-semibold text-gray-700 mb-3">Code postal *</label>
                                                <input type="text" name="codePostalProjet" class="form-input" placeholder="75002" maxlength="5" id="postal-project">
                                                <div class="error-message hidden" id="codePostalProjet-error">Code postal invalide (5 chiffres requis)</div>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-semibold text-gray-700 mb-3">Ville *</label>
                                                <input type="text" name="villeProjet" class="form-input" placeholder="Paris" id="city-project">
                                                <div class="error-message hidden" id="villeProjet-error">Ce champ est obligatoire</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Étape 3: Détails du projet -->
                        <div class="form-step" id="step-3">
                            <h2 class="text-2xl font-bold mb-6 text-gray-900">Détails du projet</h2>
                            
                            <div class="space-y-6">
                                <!-- Type de raccordement -->
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-4">
                                        Type de raccordement *
                                        <div class="tooltip ml-2 inline-block">
                                            <i class="fas fa-question-circle text-gray-400 cursor-help"></i>
                                            <span class="tooltiptext">Nouveau = première installation, Provisoire = usage temporaire, Augmentation = modifier la puissance existante</span>
                                        </div>
                                    </label>
                                    <div class="grid md:grid-cols-2 gap-4">
                                        <div class="radio-option" onclick="selectOption('typeRaccordement', 'nouveau')">
                                            <input type="radio" name="typeRaccordement" value="nouveau" class="sr-only">
                                            <div class="font-semibold">Nouveau</div>
                                            <div class="text-sm text-gray-600">Première installation</div>
                                        </div>
                                        <div class="radio-option" onclick="selectOption('typeRaccordement', 'provisoire')">
                                            <input type="radio" name="typeRaccordement" value="provisoire" class="sr-only">
                                            <div class="font-semibold">Provisoire</div>
                                            <div class="text-sm text-gray-600">Installation temporaire</div>
                                        </div>
                                        <div class="radio-option" onclick="selectOption('typeRaccordement', 'augmentation')">
                                            <input type="radio" name="typeRaccordement" value="augmentation" class="sr-only">
                                            <div class="font-semibold">Augmentation de puissance</div>
                                            <div class="text-sm text-gray-600">Modifier la puissance</div>
                                        </div>
                                        <div class="radio-option" onclick="selectOption('typeRaccordement', 'deplacement')">
                                            <input type="radio" name="typeRaccordement" value="deplacement" class="sr-only">
                                            <div class="font-semibold">Déplacement compteur</div>
                                            <div class="text-sm text-gray-600">Changer l'emplacement</div>
                                        </div>
                                        <div class="radio-option" onclick="selectOption('typeRaccordement', 'autre')">
                                            <input type="radio" name="typeRaccordement" value="autre" class="sr-only">
                                            <div class="font-semibold">Autre demande</div>
                                            <div class="text-sm text-gray-600">Autre type de raccordement</div>
                                        </div>
                                    </div>
                                    <div class="error-message hidden" id="typeRaccordement-error">Veuillez sélectionner un type de raccordement</div>
                                </div>

                                <!-- Type de projet -->
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-4">Type de projet *</label>
                                    <select name="typeProjet" required class="form-input">
                                        <option value="">Sélectionnez le type de projet</option>
                                        <option value="maison">Maison individuelle</option>
                                        <option value="immeuble">Immeuble collectif</option>
                                        <option value="commercial">Local commercial</option>
                                        <option value="terrain">Terrain nu</option>
                                        <option value="industriel">Bâtiment industriel</option>
                                    </select>
                                    <div class="error-message hidden" id="typeProjet-error">Veuillez sélectionner un type de projet</div>
                                </div>

                                <!-- Type d'alimentation -->
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-4">
                                        Type d'alimentation *
                                        <div class="tooltip ml-2 inline-block">
                                            <i class="fas fa-question-circle text-gray-400 cursor-help"></i>
                                            <span class="tooltiptext">Monophasé pour usage domestique standard (jusqu'à 9kVA), Triphasé pour gros besoins électriques (12kVA et plus)</span>
                                        </div>
                                    </label>
                                    <div class="space-y-3">
                                        <div class="radio-option" onclick="selectAlimentation('monophase')">
                                            <input type="radio" name="typeAlimentation" value="monophase" class="sr-only">
                                            <div class="font-semibold">Monophasé (3–9 kVA)</div>
                                            <div class="text-sm text-gray-600">Usage domestique standard</div>
                                        </div>
                                        <div class="radio-option" onclick="selectAlimentation('triphase')">
                                            <input type="radio" name="typeAlimentation" value="triphase" class="sr-only">
                                            <div class="font-semibold">Triphasé (12–36 kVA)</div>
                                            <div class="text-sm text-gray-600">Gros besoins électriques</div>
                                        </div>
                                        <div class="radio-option" onclick="selectAlimentation('ne-sais-pas')">
                                            <input type="radio" name="typeAlimentation" value="ne-sais-pas" class="sr-only">
                                            <div class="font-semibold">Je ne sais pas</div>
                                            <div class="text-sm text-gray-600">Nous vous conseillerons</div>
                                        </div>
                                    </div>
                                    <div class="error-message hidden" id="typeAlimentation-error">Veuillez sélectionner un type d'alimentation</div>
                                </div>

                                <!-- Puissance -->
                                <div id="puissance-section" class="hidden">
                                    <label class="block text-sm font-semibold text-gray-700 mb-4">Puissance demandée *</label>
                                    <select name="puissance" class="form-input" id="puissance-select">
                                        <option value="">Sélectionnez la puissance</option>
                                    </select>
                                    <div class="error-message hidden" id="puissance-error">Veuillez sélectionner une puissance</div>
                                </div>
                            </div>
                        </div>

                        <!-- Étape 4: Validation -->
                        <div class="form-step" id="step-4">
                            <h2 class="text-2xl font-bold mb-6 text-gray-900">Validation de votre demande</h2>
                            
                            <!-- Récapitulatif -->
                            <div class="bg-gray-50 rounded-2xl p-6 mb-8">
                                <h3 class="text-lg font-semibold mb-4 text-gray-900">Récapitulatif de votre demande</h3>
                                <div id="form-summary" class="space-y-2 text-sm">
                                    <!-- Summary will be populated by JavaScript -->
                                </div>
                            </div>

                            <!-- Détails finaux -->
                            <div class="space-y-6 mb-8">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-4">État du projet *</label>
                                    <select name="etatProjet" required class="form-input">
                                        <option value="">Sélectionnez l'état de votre projet</option>
                                        <option value="planification">Planification</option>
                                        <option value="permis-depose">Permis déposé</option>
                                        <option value="permis-obtenu">Permis obtenu</option>
                                        <option value="travaux-cours">Travaux en cours</option>
                                        <option value="travaux-termines">Travaux terminés</option>
                                    </select>
                                    <div class="error-message hidden" id="etatProjet-error">Veuillez sélectionner l'état de votre projet</div>
                                </div>

                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-4">Délai de raccordement souhaité *</label>
                                    <select name="delaiSouhaite" required class="form-input">
                                        <option value="">Sélectionnez votre délai préféré</option>
                                        <option value="1-3-mois">1-3 mois</option>
                                        <option value="3-6-mois">3-6 mois</option>
                                        <option value="plus-6-mois">Plus de 6 mois</option>
                                        <option value="des-que-possible">Dès que possible</option>
                                    </select>
                                    <div class="error-message hidden" id="delaiSouhaite-error">Veuillez sélectionner un délai</div>
                                </div>

                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-4">Commentaires additionnels</label>
                                    <textarea name="commentaires" class="form-input" rows="4" placeholder="Informations supplémentaires sur votre projet..."></textarea>
                                </div>
                            </div>

                            <!-- CGV -->
                            <div class="mb-8">
                                <label class="flex items-start">
                                    <input type="checkbox" name="acceptCGV" required class="mt-1 mr-4">
                                    <span class="text-sm text-gray-600">
                                        J'accepte les <a href="#" class="text-enedis-blue hover:underline font-medium">conditions générales de vente</a> 
                                        et confirme que les informations fournies sont exactes.
                                    </span>
                                </label>
                                <div class="error-message hidden" id="acceptCGV-error">Vous devez accepter les conditions générales</div>
                            </div>
                        </div>

                        <!-- Navigation Buttons -->
                        <div class="flex justify-between pt-8 border-t border-gray-100">
                            <button type="button" id="prev-btn" onclick="prevStep()" class="btn-secondary hidden">
                                <i class="fas fa-arrow-left mr-2"></i>
                                Précédent
                            </button>
                            <div class="flex-1"></div>
                            <button type="button" id="next-btn" onclick="nextStep()" class="btn-primary">
                                Suivant
                                <i class="fas fa-arrow-right ml-2"></i>
                            </button>
                            <button type="button" id="submit-btn" onclick="submitForm()" class="btn-primary hidden">
                                <i class="fas fa-check mr-2"></i>
                                Finaliser ma demande
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Page Paiement -->
    <div id="paiement" class="page">
        <div class="min-h-screen bg-gray-50 py-12">
            <div class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8">
                <!-- Breadcrumb -->
                <nav class="flex mb-8" aria-label="Breadcrumb">
                    <ol class="inline-flex items-center space-x-1 md:space-x-3">
                        <li class="inline-flex items-center">
                            <a href="#" onclick="showPage('home')" class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-enedis-blue">
                                <i class="fas fa-home mr-2"></i>
                                Accueil
                            </a>
                        </li>
                        <li>
                            <div class="flex items-center">
                                <i class="fas fa-chevron-right text-gray-400 mx-2"></i>
                                <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2">Paiement</span>
                            </div>
                        </li>
                    </ol>
                </nav>

                <div class="bg-white rounded-2xl shadow-lg p-8">
                    <div class="text-center mb-8">
                        <h1 class="text-3xl font-bold text-gray-900 mb-4">Finalisation de votre demande</h1>
                        <p class="text-gray-600">Paiement sécurisé de votre accompagnement administratif</p>
                    </div>

                    <div class="bg-gray-50 rounded-2xl p-6 mb-8">
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Service d'accompagnement administratif</h3>
                        <div class="flex justify-between items-center text-2xl font-bold text-enedis-blue">
                            <span>129,80€ TTC</span>
                        </div>
                        <p class="text-gray-600 mt-2">Traitement de votre dossier par nos experts</p>
                    </div>

                    <div class="mb-8">
                        <h3 class="text-lg font-semibold mb-4 text-gray-900">Récapitulatif de votre commande</h3>
                        <div id="payment-summary" class="space-y-2 text-sm bg-gray-50 p-4 rounded-lg">
                            <!-- Summary will be populated by JavaScript -->
                        </div>
                    </div>

                    <div class="text-center">
                        <button onclick="processPayment()" class="btn-primary text-lg w-full">
                            <i class="fas fa-lock mr-3"></i>
                            Payer 129,80€ TTC
                        </button>
                        <p class="text-sm text-gray-500 mt-4">
                            <i class="fas fa-shield-alt mr-2"></i>
                            Paiement 100% sécurisé via Stripe
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Page Confirmation -->
    <div id="confirmation" class="page">
        <div class="min-h-screen bg-gray-50 py-12">
            <div class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <div class="bg-white rounded-2xl shadow-lg p-8">
                    <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-check text-white text-2xl"></i>
                    </div>
                    
                    <h1 class="text-3xl font-bold text-gray-900 mb-4">Merci pour votre confiance !</h1>
                    <p class="text-gray-600 mb-8">Votre demande de raccordement Enedis a été transmise avec succès</p>
                    
                    <div class="bg-enedis-blue text-white rounded-2xl p-6 mb-8">
                        <h3 class="text-lg font-semibold mb-2">Votre numéro de référence</h3>
                        <div class="text-2xl font-bold" id="reference-number">REF-XXXX-2025</div>
                        <p class="text-sm opacity-90 mt-2">Conservez ce numéro pour le suivi de votre dossier</p>
                    </div>
                    
                    <div class="text-left space-y-6 mb-8">
                        <h3 class="text-xl font-bold text-gray-900">Prochaines étapes :</h3>
                        
                        <div class="flex items-start space-x-4">
                            <div class="w-8 h-8 bg-enedis-blue text-white rounded-full flex items-center justify-center font-bold">1</div>
                            <div>
                                <h4 class="font-semibold text-gray-900">Confirmation par email</h4>
                                <p class="text-gray-600">Vous recevrez un email de confirmation dans les prochaines minutes</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start space-x-4">
                            <div class="w-8 h-8 bg-enedis-blue text-white rounded-full flex items-center justify-center font-bold">2</div>
                            <div>
                                <h4 class="font-semibold text-gray-900">Préparation du dossier</h4>
                                <p class="text-gray-600">Nos experts préparent votre dossier sous 24h</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start space-x-4">
                            <div class="w-8 h-8 bg-enedis-green text-white rounded-full flex items-center justify-center font-bold">3</div>
                            <div>
                                <h4 class="font-semibold text-gray-900">Dépôt chez Enedis</h4>
                                <p class="text-gray-600">Votre dossier est transmis à Enedis sous 48h</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="border-t pt-6">
                        <p class="text-gray-600 mb-4">Questions ? Contactez-nous :</p>
                        <a href="tel:0970709570" class="btn-primary">
                            <i class="fas fa-phone mr-2"></i>
                            09 70 70 95 70
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Logo et description -->
            <div class="mb-12">
                <div class="flex items-center mb-6">
                    <img src="https://page1.genspark.site/v1/base64_upload/e676fe9df988ecff4cfc8149d4cbb09b" alt="Enedis Raccordement" class="h-10 w-auto mr-4">
                    <div>
                        <div class="text-white font-semibold">Votre partenaire</div>
                        <div class="text-gray-400 text-sm">raccordement au réseau d'Enedis</div>
                    </div>
                </div>
                <p class="text-gray-400 max-w-lg">
                    Service expert N°1 en France pour raccordement électrique Enedis. Accompagnement administratif pour particuliers, professionnels et collectivités.
                </p>
            </div>
            
            <div class="grid md:grid-cols-4 gap-8 mb-12">
                <!-- Raccordement Électrique -->
                <div>
                    <h3 class="text-lg font-semibold mb-6 text-enedis-green">Raccordement Électrique</h3>
                    <ul class="space-y-3 text-gray-400">
                        <li><a href="#" class="hover:text-white transition-colors">Raccordement Enedis en ligne</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Branchement maison neuve</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Demande raccordement Enedis</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Délai raccordement électrique Enedis</a></li>
                    </ul>
                </div>
                
                <!-- Services Raccordement -->
                <div>
                    <h3 class="text-lg font-semibold mb-6 text-enedis-green">Services Raccordement</h3>
                    <ul class="space-y-3 text-gray-400">
                        <li><a href="#" class="hover:text-white transition-colors">Raccordement électrique particulier</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Raccordement électrique professionnel</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Branchement compteur Linky</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Déplacement compteur électrique</a></li>
                    </ul>
                </div>
                
                <!-- Services Spécialisés -->
                <div>
                    <h3 class="text-lg font-semibold mb-6 text-enedis-green">Services Spécialisés</h3>
                    <ul class="space-y-3 text-gray-400">
                        <li><a href="#" class="hover:text-white transition-colors">Raccordement provisoire chantier</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Modification branchement électrique</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Raccordement photovoltaïque</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Viabilisation terrain électrique</a></li>
                    </ul>
                </div>
                
                <!-- Contact -->
                <div>
                    <h3 class="text-lg font-semibold mb-6 text-enedis-green">Nous contacter</h3>
                    <div class="space-y-4 text-gray-400">
                        <div class="flex items-center">
                            <i class="fas fa-phone text-enedis-green mr-3"></i>
                            <a href="tel:0970709570" class="hover:text-white transition-colors font-medium">09 70 70 95 70</a>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-envelope text-enedis-green mr-3"></i>
                            <a href="mailto:Bonjour@raccordement-elec.fr" class="hover:text-white transition-colors">Bonjour@raccordement-elec.fr</a>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-clock text-enedis-green mr-3"></i>
                            <span>Lun-Ven 8h-18h</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="border-t border-gray-800 pt-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <p class="text-gray-400 text-sm mb-4 md:mb-0">
                        © 2025 Raccordement-elec.fr. Tous droits réservés.
                    </p>
                    <p class="text-gray-500 text-sm">
                        Service indépendant d'Enedis – accompagnement administratif uniquement
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://js.stripe.com/v3/"></script>
    <script>
        // Variables globales
        let currentStep = 1;
        const maxSteps = 4;
        let formData = {};
        let addressTimeout;
        
        // Initialize Stripe
        const stripe = Stripe('pk_live_51MUY3KF0p2SYXeXzW4ebN4wdgqfmu9Mc8kTpm3XmBiyotz6kYZICKXNy73SWcmq1vCViETjWgcko8R6xd4TJbste00OL2WUCvP');

        // Navigation entre pages
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            // Google Ads tracking for form start
            if (pageId === 'formulaire') {
                gtag('event', 'conversion', {
                    'send_to': 'AW-16698052873/5o3ICMLjpMUaEtmioJo-'
                });
            }
        }

        // Menu mobile
        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }

        // User type selection
        function selectUserType(type) {
            document.querySelectorAll('#step-1 .radio-option').forEach(el => {
                el.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            document.querySelector(`input[value="${type}"]`).checked = true;
            
            const professionalFields = document.getElementById('professional-fields');
            const collectivityFields = document.getElementById('collectivity-fields');
            
            professionalFields.classList.add('hidden');
            collectivityFields.classList.add('hidden');
            
            if (type === 'professionnel') {
                professionalFields.classList.remove('hidden');
            } else if (type === 'collectivite') {
                collectivityFields.classList.remove('hidden');
            }
            
            formData.userType = type;
        }

        // Generic option selection
        function selectOption(name, value) {
            document.querySelectorAll(`input[name="${name}"]`).forEach(input => {
                input.closest('.radio-option').classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            document.querySelector(`input[name="${name}"][value="${value}"]`).checked = true;
            formData[name] = value;
        }

        // Alimentation selection with power options
        function selectAlimentation(type) {
            document.querySelectorAll('input[name="typeAlimentation"]').forEach(input => {
                input.closest('.radio-option').classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            document.querySelector(`input[value="${type}"]`).checked = true;
            
            const puissanceSection = document.getElementById('puissance-section');
            const puissanceSelect = document.getElementById('puissance-select');
            
            if (type !== 'ne-sais-pas') {
                puissanceSection.classList.remove('hidden');
                puissanceSelect.innerHTML = '<option value="">Sélectionnez la puissance</option>';
                
                if (type === 'monophase') {
                    puissanceSelect.innerHTML += `
                        <option value="3">3 kVA</option>
                        <option value="6">6 kVA</option>
                        <option value="9">9 kVA</option>
                    `;
                } else if (type === 'triphase') {
                    puissanceSelect.innerHTML += `
                        <option value="12">12 kVA</option>
                        <option value="18">18 kVA</option>
                        <option value="24">24 kVA</option>
                        <option value="36">36 kVA</option>
                    `;
                }
            } else {
                puissanceSection.classList.add('hidden');
            }
            
            formData.typeAlimentation = type;
        }

        // Phone number formatting
        function formatPhoneNumber(value) {
            const numbers = value.replace(/\D/g, '');
            const truncated = numbers.substring(0, 10);
            if (truncated.length >= 2) {
                return truncated.replace(/(\d{2})(?=\d)/g, '$1 ');
            }
            return truncated;
        }

        // French address autocomplete
        function setupAddressAutocomplete() {
            const addressInput = document.getElementById('address-input');
            const suggestionsContainer = document.getElementById('address-suggestions');
            
            if (addressInput) {
                addressInput.addEventListener('input', function() {
                    const query = this.value.trim();
                    
                    clearTimeout(addressTimeout);
                    
                    if (query.length < 3) {
                        suggestionsContainer.classList.add('hidden');
                        return;
                    }
                    
                    addressTimeout = setTimeout(() => {
                        fetch(`https://api-adresse.data.gouv.fr/search/?q=${encodeURIComponent(query)}&limit=5`)
                            .then(response => response.json())
                            .then(data => {
                                suggestionsContainer.innerHTML = '';
                                
                                if (data.features && data.features.length > 0) {
                                    data.features.forEach(feature => {
                                        const suggestion = document.createElement('div');
                                        suggestion.className = 'address-suggestion';
                                        suggestion.textContent = feature.properties.label;
                                        
                                        suggestion.addEventListener('click', () => {
                                            addressInput.value = feature.properties.name + (feature.properties.housenumber ? ` ${feature.properties.housenumber}` : '') + ` ${feature.properties.street || ''}`;
                                            document.getElementById('postal-project').value = feature.properties.postcode || '';
                                            document.getElementById('city-project').value = feature.properties.city || '';
                                            suggestionsContainer.classList.add('hidden');
                                        });
                                        
                                        suggestionsContainer.appendChild(suggestion);
                                    });
                                    
                                    suggestionsContainer.classList.remove('hidden');
                                } else {
                                    suggestionsContainer.classList.add('hidden');
                                }
                            })
                            .catch(error => {
                                console.error('Error fetching addresses:', error);
                                suggestionsContainer.classList.add('hidden');
                            });
                    }, 300);
                });
                
                // Hide suggestions when clicking outside
                document.addEventListener('click', function(e) {
                    if (!addressInput.contains(e.target) && !suggestionsContainer.contains(e.target)) {
                        suggestionsContainer.classList.add('hidden');
                    }
                });
            }
        }

        // Address management
        function setupAddressManagement() {
            const sameAddressCheckbox = document.getElementById('same-address');
            const projectFields = document.getElementById('project-address-fields');
            
            if (sameAddressCheckbox) {
                sameAddressCheckbox.addEventListener('change', function() {
                    if (this.checked) {
                        projectFields.style.display = 'none';
                        
                        // Copy facturation address to project
                        const facturationFields = ['adresseFacturation', 'complementFacturation', 'codePostalFacturation', 'villeFacturation'];
                        const projectFields = ['adresseProjet', 'complementProjet', 'codePostalProjet', 'villeProjet'];
                        
                        facturationFields.forEach((factField, index) => {
                            const factValue = document.querySelector(`input[name="${factField}"]`)?.value || '';
                            const projectInput = document.querySelector(`input[name="${projectFields[index]}"]`);
                            if (projectInput) {
                                projectInput.value = factValue;
                            }
                        });
                    } else {
                        projectFields.style.display = 'block';
                    }
                });
            }
        }

        // Form validation
        function validateStep(step) {
            const stepElement = document.getElementById(`step-${step}`);
            const requiredFields = stepElement.querySelectorAll('[required]');
            let isValid = true;
            
            // Clear previous errors
            stepElement.querySelectorAll('.error-message').forEach(error => {
                error.classList.add('hidden');
            });
            
            // Check required fields
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    const errorElement = document.getElementById(`${field.name}-error`);
                    if (errorElement) {
                        errorElement.classList.remove('hidden');
                    }
                    field.style.borderColor = '#ef4444';
                    isValid = false;
                } else {
                    field.style.borderColor = '#e5e7eb';
                }
            });
            
            // Step-specific validation
            if (step === 1) {
                const userType = document.querySelector('input[name="userType"]:checked');
                if (!userType) {
                    document.getElementById('userType-error').classList.remove('hidden');
                    isValid = false;
                }
                
                // Validate phone
                const phone = document.querySelector('input[name="telephone"]').value.replace(/\s/g, '');
                if (phone.length !== 10 || !/^[0-9]{10}$/.test(phone)) {
                    document.getElementById('telephone-error').classList.remove('hidden');
                    isValid = false;
                }
                
                // Validate email
                const email = document.querySelector('input[name="email"]').value;
                if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                    document.getElementById('email-error').classList.remove('hidden');
                    isValid = false;
                }
                
                // Validate conditional fields
                if (userType?.value === 'professionnel') {
                    const raisonSociale = document.querySelector('input[name="raisonSociale"]').value;
                    const siren = document.querySelector('input[name="siren"]').value;
                    
                    if (!raisonSociale.trim()) {
                        document.getElementById('raisonSociale-error').classList.remove('hidden');
                        isValid = false;
                    }
                    
                    if (!/^[0-9]{9}$/.test(siren)) {
                        document.getElementById('siren-error').classList.remove('hidden');
                        isValid = false;
                    }
                }
                
                if (userType?.value === 'collectivite') {
                    const nomCollectivite = document.querySelector('input[name="nomCollectivite"]').value;
                    const sirenCollectivite = document.querySelector('input[name="sirenCollectivite"]').value;
                    
                    if (!nomCollectivite.trim()) {
                        document.getElementById('nomCollectivite-error').classList.remove('hidden');
                        isValid = false;
                    }
                    
                    if (!/^[0-9]{9}$/.test(sirenCollectivite)) {
                        document.getElementById('sirenCollectivite-error').classList.remove('hidden');
                        isValid = false;
                    }
                }
            }
            
            if (step === 2) {
                // Validate postal codes
                const postalFacturation = document.querySelector('input[name="codePostalFacturation"]').value;
                const postalProjet = document.querySelector('input[name="codePostalProjet"]').value;
                
                if (!/^[0-9]{5}$/.test(postalFacturation)) {
                    document.getElementById('codePostalFacturation-error').classList.remove('hidden');
                    isValid = false;
                }
                
                const sameAddress = document.getElementById('same-address').checked;
                if (!sameAddress && !/^[0-9]{5}$/.test(postalProjet)) {
                    document.getElementById('codePostalProjet-error').classList.remove('hidden');
                    isValid = false;
                }
            }
            
            if (step === 3) {
                const typeRaccordement = document.querySelector('input[name="typeRaccordement"]:checked');
                const typeProjet = document.querySelector('select[name="typeProjet"]').value;
                const typeAlimentation = document.querySelector('input[name="typeAlimentation"]:checked');
                
                if (!typeRaccordement) {
                    document.getElementById('typeRaccordement-error').classList.remove('hidden');
                    isValid = false;
                }
                
                if (!typeProjet) {
                    document.getElementById('typeProjet-error').classList.remove('hidden');
                    isValid = false;
                }
                
                if (!typeAlimentation) {
                    document.getElementById('typeAlimentation-error').classList.remove('hidden');
                    isValid = false;
                }
                
                // Check puissance if alimentation is not "ne-sais-pas"
                if (typeAlimentation && typeAlimentation.value !== 'ne-sais-pas') {
                    const puissance = document.querySelector('select[name="puissance"]').value;
                    if (!puissance) {
                        document.getElementById('puissance-error').classList.remove('hidden');
                        isValid = false;
                    }
                }
            }
            
            if (step === 4) {
                const etatProjet = document.querySelector('select[name="etatProjet"]').value;
                const delaiSouhaite = document.querySelector('select[name="delaiSouhaite"]').value;
                const acceptCGV = document.querySelector('input[name="acceptCGV"]').checked;
                
                if (!etatProjet) {
                    document.getElementById('etatProjet-error').classList.remove('hidden');
                    isValid = false;
                }
                
                if (!delaiSouhaite) {
                    document.getElementById('delaiSouhaite-error').classList.remove('hidden');
                    isValid = false;
                }
                
                if (!acceptCGV) {
                    document.getElementById('acceptCGV-error').classList.remove('hidden');
                    isValid = false;
                }
            }
            
            return isValid;
        }

        // Step navigation
        function nextStep() {
            if (validateStep(currentStep)) {
                // Send notification after step 1
                if (currentStep === 1) {
                    sendNotification('step1');
                }
                
                if (currentStep < maxSteps) {
                    currentStep++;
                    updateStep();
                }
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStep();
            }
        }

        function updateStep() {
            // Hide all steps
            document.querySelectorAll('.form-step').forEach(step => {
                step.classList.remove('active');
            });
            
            // Show current step
            document.getElementById(`step-${currentStep}`).classList.add('active');
            
            // Update progress bar
            const progressWidth = (currentStep / maxSteps) * 100;
            document.getElementById('progress-fill').style.width = `${progressWidth}%`;
            
            // Update labels
            document.getElementById('step-label').textContent = `Étape ${currentStep} sur ${maxSteps}`;
            
            const stepTitles = [
                'Type d\'utilisateur',
                'Adresses',
                'Détails du projet',
                'Validation finale'
            ];
            document.getElementById('step-title').textContent = stepTitles[currentStep - 1];
            
            // Update buttons - THIS IS THE KEY FIX
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const submitBtn = document.getElementById('submit-btn');
            
            // Step 1: Hide prev, show next, hide submit
            if (currentStep === 1) {
                prevBtn.classList.add('hidden');
                nextBtn.classList.remove('hidden');
                submitBtn.classList.add('hidden');
            }
            // Steps 2-3: Show prev, show next, hide submit
            else if (currentStep === 2 || currentStep === 3) {
                prevBtn.classList.remove('hidden');
                nextBtn.classList.remove('hidden');
                submitBtn.classList.add('hidden');
            }
            // Step 4: Show prev, hide next, show submit
            else if (currentStep === 4) {
                prevBtn.classList.remove('hidden');
                nextBtn.classList.add('hidden');
                submitBtn.classList.remove('hidden');
                updateSummary();
            }
        }

        // Update summary
        function updateSummary() {
            const summaryEl = document.getElementById('form-summary');
            const form = document.getElementById('raccordement-form');
            const formData = new FormData(form);
            
            let summary = '<div class="grid md:grid-cols-2 gap-6">';
            
            // Personal info
            summary += '<div><h4 class="font-semibold mb-2 text-gray-900">Vos coordonnées</h4>';
            summary += `<p><strong>Type:</strong> ${formData.get('userType') || 'Non renseigné'}</p>`;
            summary += `<p><strong>Nom:</strong> ${formData.get('prenom')} ${formData.get('nom')}</p>`;
            summary += `<p><strong>Email:</strong> ${formData.get('email')}</p>`;
            summary += `<p><strong>Téléphone:</strong> ${formData.get('telephone')}</p>`;
            if (formData.get('raisonSociale')) {
                summary += `<p><strong>Entreprise:</strong> ${formData.get('raisonSociale')}</p>`;
            }
            summary += '</div>';
            
            // Project details
            summary += '<div><h4 class="font-semibold mb-2 text-gray-900">Détails du projet</h4>';
            summary += `<p><strong>Type raccordement:</strong> ${formData.get('typeRaccordement') || 'Non renseigné'}</p>`;
            summary += `<p><strong>Type projet:</strong> ${formData.get('typeProjet') || 'Non renseigné'}</p>`;
            summary += `<p><strong>Alimentation:</strong> ${formData.get('typeAlimentation') || 'Non renseigné'}</p>`;
            if (formData.get('puissance')) {
                summary += `<p><strong>Puissance:</strong> ${formData.get('puissance')} kVA</p>`;
            }
            summary += `<p><strong>Adresse projet:</strong> ${formData.get('adresseProjet')} ${formData.get('codePostalProjet')} ${formData.get('villeProjet')}</p>`;
            summary += '</div>';
            
            summary += '</div>';
            summaryEl.innerHTML = summary;
        }

        // Submit form
        function submitForm() {
            if (validateStep(currentStep)) {
                // Send form completion notification
                sendNotification('complete');
                
                // Google Ads conversion tracking
                gtag('event', 'conversion', {
                    'send_to': 'AW-16698052873/PqZMCJW-tMUaEtmioJo-'
                });
                
                // Redirect to payment
                showPage('paiement');
                updatePaymentSummary();
            }
        }

        // Update payment summary
        function updatePaymentSummary() {
            const summaryEl = document.getElementById('payment-summary');
            const form = document.getElementById('raccordement-form');
            const formData = new FormData(form);
            
            let summary = `
                <p><strong>Client:</strong> ${formData.get('prenom')} ${formData.get('nom')}</p>
                <p><strong>Type:</strong> ${formData.get('userType')}</p>
                <p><strong>Raccordement:</strong> ${formData.get('typeRaccordement')}</p>
                <p><strong>Email:</strong> ${formData.get('email')}</p>
            `;
            
            summaryEl.innerHTML = summary;
        }

        // Process payment
        function processPayment() {
            // Here you would integrate with Stripe
            // For now, simulate payment success
            setTimeout(() => {
                // Google Ads purchase conversion
                gtag('event', 'conversion', {
                    'send_to': 'AW-16698052873/IFUxCJLHtMUaEtmioJo-'
                });
                
                // Generate reference
                const reference = generateReference();
                document.getElementById('reference-number').textContent = reference;
                
                // Show confirmation page
                showPage('confirmation');
            }, 2000);
        }

        // Generate reference
        function generateReference() {
            const now = new Date();
            const year = now.getFullYear();
            const random = Math.floor(Math.random() * 9000) + 1000;
            return `REF-${random}-${year}`;
        }

        // Send notifications
        function sendNotification(type) {
            const form = document.getElementById('raccordement-form');
            const formData = new FormData(form);
            
            // Prepare notification data
            const notificationData = {
                type: type,
                userType: formData.get('userType'),
                nom: formData.get('nom'),
                prenom: formData.get('prenom'),
                email: formData.get('email'),
                telephone: formData.get('telephone'),
                timestamp: new Date().toISOString()
            };
            
            if (type === 'complete') {
                // Add all form data for complete notification
                notificationData.typeRaccordement = formData.get('typeRaccordement');
                notificationData.typeProjet = formData.get('typeProjet');
                notificationData.adresseProjet = formData.get('adresseProjet');
                notificationData.codePostalProjet = formData.get('codePostalProjet');
                notificationData.villeProjet = formData.get('villeProjet');
            }
            
            // Here you would send to your backend
            console.log('Sending notification:', notificationData);
            
            // Simulate API call
            // fetch('/api/notify', {
            //     method: 'POST',
            //     headers: { 'Content-Type': 'application/json' },
            //     body: JSON.stringify(notificationData)
            // });
        }

        // Initialization
        document.addEventListener('DOMContentLoaded', function() {
            // Setup phone formatting
            const phoneInput = document.getElementById('phone-input');
            if (phoneInput) {
                phoneInput.addEventListener('input', function() {
                    this.value = formatPhoneNumber(this.value);
                });
            }
            
            // Setup address autocomplete
            setupAddressAutocomplete();
            
            // Setup address management
            setupAddressManagement();
            
            // Initial step update
            updateStep();
        });

        // Google Ads conversion functions
        function gtag_report_conversion_start(url) {
            var callback = function () {
                if (typeof(url) != 'undefined') {
                    window.location = url;
                }
            };
            gtag('event', 'conversion', {
                'send_to': 'AW-16698052873/5o3ICMLjpMUaEtmioJo-',
                'event_callback': callback
            });
            return false;
        }
    </script>
</body>
</html>
